<h1 id="λ°μ΄ν„°-μ•”νΈν™”">λ°μ΄ν„° μ•”νΈν™”</h1>
<p>π’΅ λ³Έ λ‚΄μ©μ€ Real MySQL 8.0 1κ¶μ„ μ½μΌλ©΄μ„ μ •λ¦¬ν• λ‚΄μ©μ…λ‹λ‹¤.</p>
<ul>
<li>λ³Έλ¬Έμ— ν¬ν•¨λ μ‚¬μ§„μ μ¶μ²λ” Real MySQL 7μ¥μ…λ‹λ‹¤.</li>
</ul>
<p>μ‘μ© ν”„λ΅κ·Έλ¨μ μ•”νΈν™”λ” μ£Όμ” μ •λ³΄λ¥Ό κ°€μ§„ μΉΌλΌ λ‹¨μ„λ΅ μ•”νΈν™”λ¥Ό μν–‰ν•λ©°, λ°μ΄ν„°λ² μ΄μ¤ μμ¤€μ—μ„λ” ν…μ΄λΈ” λ‹¨μ„λ΅ μ•”νΈν™”λ¥Ό μ μ©ν•λ‹¤.</p>
<h2 id="mysql-μ„λ²„μ-λ°μ΄ν„°-μ•”νΈν™”">MySQL μ„λ²„μ λ°μ΄ν„° μ•”νΈν™”</h2>
<p>λ°μ΄ν„°λ² μ΄μ¤ μ„λ²„μ™€ λ””μ¤ν¬ μ‚¬μ΄μ λ°μ΄ν„° μ½κ³  μ“°κΈ° μ§€μ μ—μ„ μ•”νΈν™” λλ” λ³µνΈν™”λ¥Ό μν–‰ν•λ‹¤.
κ·Έλμ„ λ””μ¤ν¬ μ…μ¶λ ¥ μ΄μ™Έμ λ¶€λ¶„μ—μ„λ” μ•”νΈν™” μ²λ¦¬κ°€ ν•„μ” μ—†λ‹¤.</p>
<p>μ¦‰, <strong>InnoDB μ¤ν† λ¦¬μ§€ μ—”μ§„μ I/O λ μ΄μ–΄μ—μ„λ§ λ°μ΄ν„° μ•”νΈν™” λ° λ³µνΈν™” κ³Όμ •μ΄ μ‹¤ν–‰λλ‹¤.</strong></p>
<p><img alt="" src="https://velog.velcdn.com/images/jojehuni_9759/post/fb91545d-9d3a-4664-bcbd-9687986715be/image.png" /></p>
<ul>
<li>μ•”νΈν™”λ ν…μ΄λΈ”λ„ κ·Έλ ‡μ§€ μ•μ€ ν…μ΄λΈ”κ³Ό λ™μΌν• μΏΌλ¦¬ μ²λ¦¬ κ³Όμ •μ„ κ±°μΉλ‹¤.<ul>
<li>MySQL λ‚΄λ¶€μ™€ μ‚¬μ©μ μ…μ¥μ—μ„λ” μ•„λ¬΄λ° μ°¨μ΄κ°€ μ—†κΈ° λ•λ¬Έμ΄λ‹¤.</li>
</ul>
</li>
</ul>
<p>μ΄λ¬ν• μ•”νΈν™” λ°©μ‹μ„ <strong>TDE(Transparent Data Encryption, ν¬λ…ν• λ°μ΄ν„° μ•”νΈν™”)</strong>μ΄λΌκ³  ν•¨</p>
<hr />
<h3 id="2λ‹¨κ³„-ν‚¤-κ΄€λ¦¬">2λ‹¨κ³„ ν‚¤ κ΄€λ¦¬</h3>
<p>MySQL μ„λ²„μ TDEμ—μ„ μ•”νΈν™” ν‚¤λ” ν‚¤λ§(KeyRing) ν”λ¬κ·ΈμΈμ— μν•΄ κ΄€λ¦¬λλ‹¤.</p>
<ul>
<li>keyring_file File-Based ν”λ¬κ·ΈμΈ</li>
<li>keyring_encrypted_file Keyring ν”λ¬κ·ΈμΈ</li>
<li>keyring_okv KMIP ν”λ¬κ·ΈμΈ</li>
<li>keyring_aws Amazon Web Services Keyring ν”λ¬κ·ΈμΈ</li>
</ul>
<p>μ„μ™€ κ°™μ€ λ‹¤μ–‘ν• ν”λ¬κ·ΈμΈμ΄ μ κ³µλμ§€λ§, λ§μ¤ν„° ν‚¤λ¥Ό μ‚¬μ©ν•λ” λ°©λ²•λ§ λ‹¤λ¥Ό λΏ MySQL μ„λ²„ λ‚΄λ¶€μ μΌλ΅ μ‘λ™ν•λ” λ°©μ‹μ€ λ¨λ‘ λ™μΌν•λ‹¤.</p>
<p>ν‚¤λ§ ν”λ¬κ·ΈμΈμ€ 2λ‹¨κ³„(2-Tier) ν‚¤ κ΄€λ¦¬ λ°©μ‹μ„ μ‚¬μ©ν•¨</p>
<p><img alt="" src="https://velog.velcdn.com/images/jojehuni_9759/post/114974cd-e3a6-4447-982a-4f4e451a8867/image.png" /></p>
<ul>
<li><p>2λ‹¨κ³„ μ•”νΈν™” μ•„ν‚¤ν…μ² μ‚¬μ§„μ΄λ‹¤.</p>
</li>
<li><p>λ°μ΄ν„° μ•”νΈν™”λ” <strong>λ§μ¤ν„° ν‚¤</strong>μ™€ <strong>ν…μ΄λΈ”μ¤νμ΄μ¤ ν‚¤</strong>λ¥Ό κ°€μ§€κ³  μλ‹¤.</p>
<ul>
<li>μ™Έλ¶€ ν‚¤ κ΄€λ¦¬ μ†”λ£¨μ… λλ” λ””μ¤ν¬ νμΌμ—μ„ λ§μ¤ν„° ν‚¤λ¥Ό κ°€μ Έμ¨λ‹¤.</li>
<li>μ•”νΈν™”λ ν…μ΄λΈ”μ΄ μƒμ„±λ  λ•λ§λ‹¤ ν•΄λ‹Ή ν…μ΄λΈ”μ„ μ„ν• ν…μ΄λΈ”μ¤νμ΄μ¤ ν‚¤λ¥Ό λ°κΈ‰ν•λ‹¤.</li>
<li>MySQL μ„λ²„λ” <strong>λ§μ¤ν„° ν‚¤λ¥Ό μ΄μ©ν•΄ ν…μ΄λΈ”μ¤νμ΄μ¤ ν‚¤λ¥Ό μ•”νΈν™”</strong>ν•΄μ„ κ° ν…μ΄λΈ”μ λ°μ΄ν„° νμΌ ν—¤λ”μ— μ €μ¥ν•λ‹¤.</li>
</ul>
</li>
<li><p>ν…μ΄λΈ”μ¤νμ΄μ¤ ν‚¤λ” ν…μ΄λΈ”μ΄ μ‚­μ λμ§€ μ•λ” μ΄μƒ μ λ€ λ³€κ²½λμ§€ μ•λ”λ‹¤.</p>
<ul>
<li>MySQL μ„λ²„ μ™Έλ¶€λ΅λ„ μ λ€ λ…Έμ¶λμ§€ μ•λ”λ‹¤.</li>
</ul>
</li>
<li><p>λ§μ¤ν„° ν‚¤λ” μ™Έλ¶€λ΅ λ…Έμ¶λ  μ μκΈ° λ•λ¬Έμ— μ£ΌκΈ°μ μΌλ΅ λ³€κ²½ν•΄μ•Ό ν•λ‹¤.</p>
<ul>
<li><code>ALTER INSTANCE ROTATE INNODB MASTER KEY;</code></li>
<li><strong>μ•”νΈν™” ν‚¤ λ³€κ²½μΌλ΅ μΈν• κ³Όλ„ν• μ‹μ¤ν… λ¶€ν•λ¥Ό ν”Όν•κΈ° μ„ν•΄ 2λ‹¨κ³„ μ•”νΈν™” λ°©μ‹μ„ μ‚¬μ©ν•λ‹¤.</strong></li>
</ul>
</li>
</ul>
<hr />
<h3 id="μ•”νΈν™”μ™€-μ„±λ¥">μ•”νΈν™”μ™€ μ„±λ¥</h3>
<ul>
<li><p>MySQL μ„λ²„μ μ•”νΈν™”λ” TDE λ°©μ‹ β‡’ λ””μ¤ν¬λ΅λ¶€ν„° ν• λ² μ½μ€ λ°μ΄ν„° νμ΄μ§€λ” λ³µνΈν™”λμ–΄ InnoDB λ²„νΌ ν’€μ— μ μ¬λλ‹¤.</p>
<ul>
<li><strong>λ°μ΄ν„° νμ΄μ§€κ°€ ν• λ² λ©”λ¨λ¦¬μ— μ μ¬λλ©΄ μ•”νΈν™”λμ§€ μ•μ€ ν…μ΄λΈ”κ³Ό λ™μΌν• μ„±λ¥</strong>μ„ λ³΄μΈλ‹¤.</li>
</ul>
</li>
<li><p>InnoDB <strong>λ²„νΌ ν’€μ— μ΅΄μ¬ν•μ§€ μ•λ” λ°μ΄ν„°λ¥Ό μ½μ„ κ²½μ°</strong></p>
<ul>
<li><strong>λ³µνΈν™” κ³Όμ •</strong>μ„ κ±°μ³μ•Ό ν•λ‹¤. -&gt; μ¦‰, <strong>μΏΌλ¦¬ μ²λ¦¬κ°€ μ§€μ—°</strong>λλ‹¤.</li>
</ul>
</li>
<li><p><strong>μ•”νΈν™”λ ν…μ΄λΈ”μ΄ λ³€κ²½λλ” κ²½μ°</strong></p>
<ul>
<li>λ‹¤μ‹ λ””μ¤ν¬λ΅ λ™κΈ°ν™”λ  λ• μ•”νΈν™” λμ–΄μ•Ό ν•λ‹¤. -&gt; μ¦‰, <strong>λ””μ¤ν¬ μ €μ¥ μ‹ μ¶”κ°€ μ‹κ°„μ΄ κ±Έλ¦Ό</strong></li>
</ul>
</li>
<li><p>SELECT, UPDATE, DELETE λ…λ Ήμ„ μ‹¤ν–‰ν•λ” κ²½μ°</p>
<ul>
<li>λ³€κ²½ν•κ³ μ ν•λ” λ μ½”λ“λ¥Ό InnoDB λ²„νΌ ν’€λ΅ μ½μ–΄μ™€μ•Ό ν•λ‹¤.</li>
<li><strong>μ¦‰, μƒλ΅­κ² λ””μ¤ν¬μ—μ„ μ½μ–΄μ•Ό ν•λ” λ°μ΄ν„° νμ΄μ§€μ κ°μμ— λ”°λΌ λ³µνΈν™” μ§€μ—°μ΄ λ°μƒν•λ‹¤.</strong></li>
</ul>
</li>
<li><p>μ•”νΈν™”ν•λ‹¤κ³  ν•΄μ„ InnoDB λ²„νΌ ν’€μ ν¨μ¨μ΄ λ‹¬λΌμ§€κ±°λ‚ λ©”λ¨λ¦¬ μ‚¬μ© ν¨μ¨μ΄ λ–¨μ–΄μ§€λ” ν„μƒμ€ λ°μƒν•μ§€ μ•λ”λ‹¤.</p>
<ul>
<li>λ°μ΄ν„° νμ΄μ§€λ” μ•”νΈν™” ν‚¤λ³΄λ‹¤ ν›¨μ”¬ ν¬κΈ° λ•λ¬Έ</li>
</ul>
</li>
<li><p><strong>κ°™μ€ ν…μ΄λΈ”μ— λ€ν•΄ μ•”νΈν™”μ™€ μ••μ¶•μ΄ λ™μ‹μ— μ μ©λλ©΄ μ••μ¶•μ„ λ¨Όμ € μ‹¤ν–‰ν•κ³  μ•”νΈν™”λ¥Ό μ μ©ν•¨</strong></p>
<ul>
<li>μ•”νΈν™”λ κ²°κ³Όλ¬Έμ€ μ••μ¶•λ¥ μ΄ λ–¨μ–΄μ§</li>
<li>μ•”νΈν™”κ°€ λ¨Όμ € μ‹¤ν–‰λλ‹¤λ©΄, InnoDB λ²„νΌ ν’€μ— μ΅΄μ¬ν•λ” λ°μ΄ν„° νμ΄μ§€μ— λ€ν•΄μ„λ„ λ§¤λ² μ•”λ³µνΈν™” μ‘μ—…μ„ μν–‰ν•΄μ•Ό λ¨</li>
</ul>
</li>
<li><p>μ•”νΈν™”λ ν…μ΄λΈ”μ κ²½μ° μ½κΈ°λ” 3<del>5λ°°, μ“°κΈ°λ” 5</del>6λ°°μ •λ„ λλ¦Ό</p>
</li>
</ul>
<hr />
<h3 id="μ•”νΈν™”μ™€-λ³µμ ">μ•”νΈν™”μ™€ λ³µμ </h3>
<p>MySQL μ„λ²„μ λ³µμ μ—μ„ λ ν”λ¦¬μΉ΄ μ„λ²„λ” μ†μ¤ μ„λ²„μ λ¨λ“  μ‚¬μ©μ λ°μ΄ν„°λ¥Ό λ™κΈ°ν™”ν•κΈ° λ•λ¬Έμ— μ‹¤μ  λ°μ΄ν„° νμΌλ„ λ™λ¦¬ν•  κ²ƒμ΄λΌ μƒκ°ν•  μ μλ‹¤.</p>
<p>ν•μ§€λ§, TDEλ¥Ό μ΄μ©ν• μ•”νΈν™” μ‚¬μ© μ‹ -&gt; λ§μ¤ν„° ν‚¤μ™€ λ°μ΄λΈ”μ¤νμ΄μ¤ ν‚¤λ” κ·Έλ ‡μ§€ μ•λ‹¤.</p>
<p>MySQL μ„λ²„μ—μ„ κΈ°λ³Έμ μΌλ΅ λ¨λ“  λ…Έλ“λ” κ°μμ λ§μ¤ν„° ν‚¤λ¥Ό ν• λ‹Ήν•΄μ•Ό ν•λ‹¤.</p>
<p>DB μ„λ²„μ λ΅μ»¬ λ””λ ‰ν„°λ¦¬μ— λ§μ¤ν„° ν‚¤λ¥Ό κ΄€λ¦¬ν•  λ•λ” λ‘ μ„λ²„κ°€ λ‹¤λ¥Έ ν‚¤λ¥Ό κ°€μ§ μλ°–μ— μ—†κ² μ§€λ§, μ›κ²©μΌλ΅ ν‚¤ κ΄€λ¦¬ μ†”λ£¨μ…μ„ μ‚¬μ©ν•λ” κ²½μ°μ—λ„ λ‘ μ„λ²„λ” μ„λ΅ λ‹¤λ¥Έ λ§μ¤ν„° ν‚¤λ¥Ό κ°–λ„λ΅ ν•΄μ•Ό ν•λ‹¤.</p>
<p>=&gt; μ• μ΄μ— λ§μ¤ν„° ν‚¤ μμ²΄κ°€ λ ν”λ¦¬μΉ΄λ΅ λ³µμ λμ§€ μ•μ•„ ν…μ΄λΈ” μ¤νμ΄μ¤ ν‚¤λ„ λ³µμ λμ§€ μ•λ”λ‹¤.</p>
<blockquote>
<p>μ¦‰, μ†μ¤ μ„λ²„μ™€ λ ν”λ¦¬μΉ΄ μ„λ²„λ” μ„λ΅ κ°μμ λ§μ¤ν„° ν‚¤μ™€ ν…μ΄λΈ”μ¤νμ΄μ¤ ν‚¤λ¥Ό κ΄€λ¦¬ν•λ‹¤.
κ·Έλμ„ μ‹¤μ  μ•”νΈν™”λ λ°μ΄ν„°κ°€ μ €μ¥λ λ°μ΄ν„° νμΌμ λ‚΄μ©μ€ μ™„μ „ν λ‹¬λΌμ§„λ‹¤.</p>
</blockquote>
<p>λ³µμ  μ†μ¤ μ„λ²„μ λ§μ¤ν„° ν‚¤λ¥Ό λ³€κ²½ν•  λ•λ”</p>
<pre><code class="language-sql">ALTER INSTANCE ROTATE INNODB MASTER KEY</code></pre>
<p>μ„μ λ…λ Ήμ„ μ‹¤ν–‰ν•λ”λ°, μ΄ λ• μ΄ λ…λ Ή μμ²΄λ” λ ν”λ¦¬μΉ΄ μ„λ²„λ΅ λ³µμ λμ§€λ§, μ‹¤μ λ΅ μ „λ‹¬λλ” κ²ƒμ€ μ•„λ‹λ‹¤.</p>
<blockquote>
<p>λ§μ¤ν„° ν‚¤ λ΅ν…μ΄μ…μ„ μ‹¤ν–‰ν•λ©΄ μ†μ¤ μ„λ²„μ™€ λ ν”λ¦¬μΉ΄ μ„λ²„κ°€ κ°κ° μ„λ΅ λ‹¤λ¥Έ λ§μ¤ν„° ν‚¤λ¥Ό μƒλ΅ λ°κΈ‰λ°›λ”λ‹¤.</p>
</blockquote>
<p>MySQL μ„λ²„μ λ°±μ—…μ—μ„ TDEμ ν‚¤λ§ νμΌμ„ λ°±μ—…ν•μ§€ μ•λ” κ²½μ°κ°€ μλ‹¤. =&gt; μ΄ κ²½μ° ν‚¤λ§ νμΌμ„ μ°Ύμ§€ λ»ν•λ©΄ λ°μ΄ν„° λ³µκµ¬κ°€ λ¶κ°€λ¥ν•΄μ§„λ‹¤.</p>
<p>λ§μ•½, ν‚¤λ§ νμΌκ³Ό λ°μ΄ν„° λ°±μ—…μ„ λ³„λ„λ΅ λ°±μ—…ν•λ‹¤λ©΄, λ§μ¤ν„° ν‚¤ λ΅ν…μ΄μ… λ…λ ΉμΌλ΅ TDEμ λ§μ¤ν„° ν‚¤κ°€ μ–Έμ  λ³€κ²½λλ”μ§€ κΈ°μ–µν•΄λ‘¬μ•Ό ν•λ‹¤.</p>
<blockquote>
<p><strong>λ¬Όλ΅  λ³΄μ•μ„ μ„ν•΄ λ³„λ„λ΅ λ³΄κ΄€ν•λ” κ²ƒμ„ κ¶μ¥ν•κΈ΄ ν•λ‹¤. κ·ΈλΌμ—λ„ λ³µκµ¬λ¥Ό κ°μ•ν•κ³  λ°±μ—… λ°©μ‹μ„ μ„ νƒν•΄μ•Ό ν•λ‹¤.</strong></p>
</blockquote>
<hr />
<h2 id="keyring_file-ν”λ¬κ·ΈμΈ-μ„¤μΉ">keyring_file ν”λ¬κ·ΈμΈ μ„¤μΉ</h2>
<p>TDEμ μ•”νΈν™” ν‚¤ κ΄€λ¦¬λ” ν”λ¬κ·ΈμΈ λ°©μ‹μΌλ΅ μ κ³µλλ‹¤.</p>
<ul>
<li><p><code>keyring_file</code> ν”λ¬κ·ΈμΈμ€ ν…μ΄λΈ”μ¤νμ΄μ¤ ν‚¤λ¥Ό μ•”νΈν™”ν•κΈ° μ„ν•΄ <strong>λ§μ¤ν„° ν‚¤λ¥Ό λ””μ¤ν¬ νμΌλ΅ κ΄€λ¦¬ν•¨</strong></p>
<ul>
<li>λ§μ¤ν„° ν‚¤κ°€ μ €μ¥λ νμΌμ΄ μ™Έλ¶€μ— λ…Έμ¶λλ©΄ λ°μ΄ν„° μ•”νΈν™”λ” λ¬΄μ©μ§€λ¬Όλλ‹¤.. μ΅°μ‹¬.</li>
</ul>
</li>
<li><p>TDE ν”λ¬κ·ΈμΈμ€ κ°€μ¥ λΉ¨λ¦¬ μ΄κΈ°ν™”λΌμ•Ό ν•λ―€λ΅ MySQL μ„λ²„μ μ„¤μ • νμΌ(my.cnf)μ— λ‹¤μμ„ μ¶”κ°€ν•λ©΄ λλ‹¤.</p>
<ul>
<li>λΌμ΄λΈλ¬λ¦¬ λ…μ‹<ul>
<li><code>early-plugin-load = keyring_file.so</code></li>
</ul>
</li>
<li>λ§μ¤ν„° ν‚¤λ¥Ό μ €μ¥ν•  νμΌ κ²½λ΅ μ„¤μ •<ul>
<li><code>keyring_file_data = /very/secure/directory/tde_master.key</code></li>
</ul>
</li>
</ul>
</li>
<li><p><code>SHOW PLUGINS</code> λ…λ ΉμΌλ΅ <code>keyring_file</code> ν”λ¬κ·ΈμΈμ μ΄κΈ°ν™” μ—¬λ¶€ ν™•μΈ κ°€λ¥</p>
</li>
</ul>
<hr />
<h2 id="ν…μ΄λΈ”-μ•”νΈν™”">ν…μ΄λΈ” μ•”νΈν™”</h2>
<p>ν‚¤λ§ ν”λ¬κ·ΈμΈμ€ λ§μ¤ν„° ν‚¤λ¥Ό μƒμ„±ν•κ³  κ΄€λ¦¬ν•λ” λ¶€λ¶„κΉμ§€λ§ λ‹΄λ‹Ήν•λ‹¤.</p>
<p>λ”°λΌμ„ μ–΄λ–¤ ν‚¤λ§ ν”λ¬κ·ΈμΈμ„ μ‚¬μ©ν•λ“ μ§€ μ•”νΈν™”λ ν…μ΄λΈ”μ„ μƒμ„±ν•κ³  ν™μ©ν•λ” λ°©λ²•μ€ λ¨λ‘ λ™μΌν•λ‹¤.</p>
<h3 id="ν…μ΄λΈ”-μƒμ„±">ν…μ΄λΈ” μƒμ„±</h3>
<p><code>ENCRYPTION='Y'</code> μµμ…λ§ λ„£μΌλ©΄ λ¨</p>
<pre><code class="language-sql">mysql&gt; CREATE TABLE tab_encrypted (
        id INT,
        data VARCHAR(100),
        PRIMARY KEY(id)
    ) ENCRYPTION='Y';</code></pre>
<p>λ¨λ“  ν…μ΄λΈ”μ— μ•”νΈν™”λ¥Ό μ μ©ν•λ ¤λ©΄ <code>default_table_encryptioni</code> μ‹μ¤ν… λ³€μλ¥Ό <code>ON</code>μΌλ΅ μ„¤μ •ν•λ©΄ λ¨</p>
<hr />
<h3 id="μ‘μ©-ν”„λ΅κ·Έλ¨-μ•”νΈν™”μ™€μ-λΉ„κµ">μ‘μ© ν”„λ΅κ·Έλ¨ μ•”νΈν™”μ™€μ λΉ„κµ</h3>
<p>μ‘μ© ν”„λ΅κ·Έλ¨μ—μ„ μ§μ ‘ μ•”νΈν™”ν•΄μ„ MySQL μ„λ²„μ— μ €μ¥ν•λ” κ²½μ°λ„ μλ‹¤.</p>
<p>μ΄ κ²½μ°μ—λ” μ•„λμ™€ κ°™μ΄ λ  μ μλ‹¤.</p>
<ol>
<li>μΉΌλΌ κ°’μ μ•”νΈν™” μ—¬λ¶€λ¥Ό μ„λ²„κ°€ μΈμ§€ν•μ§€ λ»ν•λ‹¤.</li>
<li>μ•”νΈν™”λ μΉΌλΌμ€ μΈλ±μ¤μ κΈ°λ¥μ„ 100% ν™μ©ν•μ§€ λ»ν•λ‹¤.</li>
<li>μ•”νΈνλ μΉΌλΌμ„ κΈ°μ¤€μΌλ΅ μ •λ ¬ν•λ” μΏΌλ¦¬λ¥Ό μ‚¬μ©ν•μ§€ λ»ν•λ‹¤.</li>
</ol>
<p>3 - 1.MySQL μ„λ²„λ” μ΄λ―Έ μ•”νΈν™”λ κ°’μ„ κΈ°μ¤€μΌλ΅ μ •λ ¬ν•λ‹¤. κ·Έλμ„ μ•”νΈν™” λκΈ° μ „μ κ°’μ„ κΈ°μ¤€μΌλ΅ μ •λ ¬ν•  μ μ—†λ‹¤.</p>
<blockquote>
<p>μ¦‰, κ³ λ―Όν•  ν•„μ” μ—†μ΄ MySQL μ„λ²„μ μ•”νΈν™” κΈ°λ¥μ„ μ„ νƒν• κ²ƒμ„ κ¶μ¥ν•λ‹¤.</p>
</blockquote>
<hr />
<h3 id="ν…μ΄λΈ”μ¤νμ΄μ¤-μ΄λ™">ν…μ΄λΈ”μ¤νμ΄μ¤ μ΄λ™</h3>
<ul>
<li>ν…μ΄λΈ”μ¤νμ΄μ¤ μ΄λ™ κΈ°λ¥μ΄ ν›¨μ”¬ ν¨μ¨μ μ΄κ³  λΉ λ¥Έ κ²½μ°<ul>
<li>ν…μ΄λΈ”μ„ λ‹¤λ¥Έ μ„λ²„λ΅ λ³µμ‚¬ν•΄μ•Ό ν•  λ•</li>
<li>νΉμ • ν…μ΄λΈ”μ λ°μ΄ν„° νμΌλ§ λ°±μ—…ν–λ‹¤κ°€ λ³µκµ¬ν•΄μ•Ό ν•  λ•</li>
</ul>
</li>
</ul>
<p><code>FLUSTH TABLES</code> λ…λ ΉμΌλ΅ ν…μ΄λΈ”μ¤νμ΄μ¤ <code>Export</code> κ°€λ¥</p>
<pre><code class="language-sql">mysql&gt; FLUSH TABLES source_table FOR EXPORT;</code></pre>
<h4 id="μ•”νΈν™”λμ§€-μ•μ€-ν…μ΄λΈ”μ-ν…μ΄λΈ”μ¤νμ΄μ¤-λ³µμ‚¬-κ³Όμ •">μ•”νΈν™”λμ§€ μ•μ€ ν…μ΄λΈ”μ ν…μ΄λΈ”μ¤νμ΄μ¤ λ³µμ‚¬ κ³Όμ •</h4>
<ol>
<li><code>FLUSTH TABLES</code> λ…λ Ή μ‹¤ν–‰</li>
<li>source_tableμ μ €μ¥λμ§€ μ•μ€ λ³€κ²½ μ‚¬ν•­μ„ λ¨λ‘ λ””μ¤ν¬λ΅ κΈ°λ΅ν•λ‹¤.</li>
<li>λ” μ΄μƒ source_tableμ— μ ‘κ·Όν•  μ μ—†κ² μ κΈμ„ κ±΄λ‹¤.</li>
<li>source_tableμ κµ¬μ΅°λ¥Ό <code>source_table.cfg</code> νμΌλ΅ κΈ°λ΅</li>
<li>λ°μ΄ν„° νμΌκ³Ό <code>source_table.cfg</code> νμΌμ„ λ©μ μ§€ μ„λ²„λ΅ λ³µμ‚¬</li>
</ol>
<h4 id="μ•”νΈν™”λ-ν…μ΄λΈ”μ-ν…μ΄λΈ”μ¤νμ΄μ¤-λ³µμ‚¬-κ³Όμ •">μ•”νΈν™”λ ν…μ΄λΈ”μ ν…μ΄λΈ”μ¤νμ΄μ¤ λ³µμ‚¬ κ³Όμ •</h4>
<ol>
<li><code>FLUSTH TABLES</code> λ…λ Ή μ‹¤ν–‰</li>
<li>μ„μ‹λ΅ μ‚¬μ©ν•  λ§μ¤ν„° ν‚¤ λ°κΈ‰ν•΄μ„ <code>source_table.cfp</code> νμΌλ΅ κΈ°λ΅ν•λ‹¤.</li>
<li>κΈ°μ΅΄ λ§μ¤ν„° ν‚¤λ¥Ό μ΄μ©ν•΄μ„ μ•”νΈν™”λ ν…μ΄λΈ”μ ν…μ΄λΈ”μ¤νμ΄μ¤ ν‚¤λ¥Ό λ³µνΈν™”ν•λ‹¤.</li>
<li>μ„μ‹λ΅ λ°κΈ‰λ λ§μ¤ν„° ν‚¤λ¥Ό μ΄μ©ν•΄μ„ ν…μ΄λΈ”μ¤νμ΄μ¤ ν‚¤λ¥Ό λ‹¤μ‹ μ•”νΈν™”ν•΄μ„ λ°μ΄ν„° νμΌμ ν—¤λ” λ¶€λ¶„μ— μ €μ¥ν•λ‹¤.</li>
<li>λ°μ΄ν„° νμΌκ³Ό <code>source_table.cfp</code> νμΌμ„ λ©μ μ§€ μ„λ²„λ΅ λ³µμ‚¬ν•λ‹¤.</li>
</ol>
<hr />
<h2 id="μ–Έλ‘-λ΅κ·Έ-λ°-λ¦¬λ‘-λ΅κ·Έ-μ•”νΈν™”">μ–Έλ‘ λ΅κ·Έ λ° λ¦¬λ‘ λ΅κ·Έ μ•”νΈν™”</h2>
<p>MySQL 8.0.16 λ²„μ „λ¶€ν„° <code>innodb_undo_log_encrypt</code>, <code>innodb_redo_log_encrypt</code> μ‹μ¤ν… λ³€μλ¥Ό μ΄μ©ν•΄ InnoDB μ¤ν† λ¦¬μ§€ μ—”μ§„μ <strong>λ¦¬λ‘ λ΅κ·Έμ™€ μ–Έλ‘ λ΅κ·Έλ¥Ό μ•”νΈν™”λ μƒνƒλ΅ μ €μ¥ν•  μ μλ‹¤.</strong></p>
<p>ν…μ΄λΈ”μ μ•”νΈν™”λ” μΌλ‹¨ ν…μ΄λΈ” ν•λ‚μ— μ•”νΈν™”κ°€ μ μ©λλ©΄ ν•΄λ‹Ή ν…μ΄λΈ”μ λ¨λ“  λ°μ΄ν„°κ°€ μ•”νΈν™”λΌμ•Ό ν•λ‹¤.</p>
<p>ν•μ§€λ§ λ¦¬λ‘ λ΅κ·Έλ‚ μ–Έλ‘ λ΅κ·Έλ” κ·Έλ ‡κ² μ μ©ν•  μ μ—†λ‹¤.</p>
<blockquote>
<p>μ¦‰, μ‹¤ν–‰ μ¤‘μΈ MySQL μ„λ²„μ—μ„ μ–Έλ‘ λ΅κ·Έλ‚ λ¦¬λ‘ λ΅κ·Έλ¥Ό ν™μ„±ν™”ν•λ‹¤κ³  ν•΄λ„, λ¨λ“  λ¦¬λ‘ λ΅κ·Έλ‚ μ–Έλ‘ λ΅κ·Έμ λ°μ΄ν„°λ¥Ό ν•΄λ‹Ή μ‹μ μ— ν• λ²μ— μ•”νΈν™”ν•΄μ„ λ‹¤μ‹ μ €μ¥ν•  μ μ—†λ‹¤.</p>
</blockquote>
<p>κ·Έλμ„ μ•„λμ™€ κ°™μ€ κ²½μ°λ“¤μ΄ μλ‹¤.</p>
<ol>
<li><p>λ¦¬λ‘ λ΅κ·Έλ‚ μ–Έλ‘ λ΅κ·Έλ¥Ό ν‰λ¬ΈμΌλ΅ μ €μ¥ν•λ‹¤κ°€ μ•”νΈν™”κ°€ ν™μ„±ν™”λλ” κ²½μ°</p>
<ul>
<li>κ·Έλ•λ¶€ν„° μƒμ„±λλ” λ¦¬λ‘ λ΅κ·Έλ‚ μ–Έλ‘ λ΅κ·Έλ§ μ•”νΈν™”ν•΄μ„ μ €μ¥</li>
<li>λΉ„ν™μ„±ν™” λλ” κ²½μ°λ„ λ§μ°¬κ°€μ§€</li>
</ul>
</li>
<li><p>λ¦¬λ‘ λ΅κ·Έμ™€ μ–Έλ‘ λ΅κ·Έ λ°μ΄ν„° λ¨λ‘ κ°κ°μ ν…μ΄λΈ”μ¤νμ΄μ¤ ν‚¤λ΅ μ•”νΈν™” λ¨</p>
<ul>
<li>ν…μ΄λΈ”μ¤νμ΄μ¤ ν‚¤λ” λ‹¤μ‹ λ§μ¤ν„° ν‚¤λ΅ μ•”νΈν™”λ¨</li>
</ul>
</li>
</ol>
<blockquote>
<p>μ¦‰, λ¦¬λ‘ λ΅κ·Έμ™€ μ–Έλ‘ λ΅κ·Έλ¥Ό μ„ν• κ°κ°μ ν”„λΌμ΄λΉ— ν‚¤κ°€ λ°κΈ‰λκ³ , ν•΄λ‹Ή ν”„λΌμ΄λΉ— ν‚¤λ” λ§μ¤ν„° ν‚¤λ΅ μ•”νΈν™”λμ–΄ λ¦¬λ‘ λ΅κ·Έ νμΌκ³Ό μ–Έλ‘ λ΅κ·Έ νμΌμ ν—¤λ”μ— μ €μ¥λ¨</p>
</blockquote>
<p><strong>InnoDB λ¦¬λ‘ λ΅κ·Έμ μ•”νΈν™” μ—¬λ¶€ ν™•μΈ λ°©λ²•</strong></p>
<pre><code class="language-sql">mysql&gt; SHOW GLOBAL VARIABLES LIKE 'innodb_redo_log_encrypt';
+-------------------------+-------+
| Variable_name           | Value |
+-------------------------+-------+
| innodb_redo_log_encrypt | OFF   |</code></pre>
<hr />
<h2 id="λ°”μ΄λ„λ¦¬-λ΅κ·Έ-μ•”νΈν™”">λ°”μ΄λ„λ¦¬ λ΅κ·Έ μ•”νΈν™”</h2>
<h3 id="λ°”μ΄λ„λ¦¬-λ΅κ·Έ-μ•”νΈν™”-ν‚¤-κ΄€λ¦¬">λ°”μ΄λ„λ¦¬ λ΅κ·Έ μ•”νΈν™” ν‚¤ κ΄€λ¦¬</h3>
<p>λ°”μ΄λ„λ¦¬ λ΅κ·Έ νμΌμ μ•”νΈν™”λ” μƒν™©μ— λ”°λΌ μ¤‘μ”λ„κ°€ λ†’μ•„μ§ μ μλ‹¤.
λ°”μ΄λ„λ¦¬ λ΅κ·Έμ™€ λ¦΄λ μ΄ λ΅κ·Έ νμΌ λ°μ΄ν„°μ μ•”νΈν™”λ¥Ό μ„ν•΄ <strong>2λ‹¨κ³„ μ•”νΈν™” ν‚¤ κ΄€λ¦¬ λ°©μ‹μ„ μ‚¬μ©</strong>ν•λ‹¤.</p>
<p><img alt="" src="https://velog.velcdn.com/images/jojehuni_9759/post/8646ea15-3750-4724-aae8-40e290212a45/image.png" /></p>
<p><strong>νμΌ ν‚¤λ΅ λ΅κ·Έ νμΌμ λ°μ΄ν„°λ¥Ό μ•”νΈν™”</strong>ν•΄μ„ λ””μ¤ν¬μ— γ…“μ¥ν•λ‹¤.</p>
<ul>
<li><strong>νμΌ ν‚¤λ” λ°”μ΄λ„λ¦¬ λ΅κ·Έ μ•”νΈν™” ν‚¤λ΅ μ•”νΈν™”</strong>ν•΄μ„ κ° λ°”μ΄λ„λ¦¬ λ΅κ·Έμ™€ λ¦΄λ μ΄ λ΅κ·Έ νμΌμ ν—¤λ”μ— μ €μ¥ν•λ‹¤.<ul>
<li>μ¦‰, <strong>λ°”μ΄λ„λ¦¬ λ΅κ·Έ μ•”νΈν™” ν‚¤λ” λ§μ¤ν„° ν‚¤μ™€ λ™μΌν• μ—­ν• </strong></li>
</ul>
</li>
</ul>
<hr />
<h3 id="λ°”μ΄λ„λ¦¬-λ΅κ·Έ-μ•”νΈν™”-ν‚¤-λ³€κ²½">λ°”μ΄λ„λ¦¬ λ΅κ·Έ μ•”νΈν™” ν‚¤ λ³€κ²½</h3>
<p><code>ALTER INSTANCE ROTATE BINLOG MASTER KEY</code> λ…λ ΉμΌλ΅ λ°”μ΄λ„λ¦¬ μ•”νΈν™” ν‚¤λ¥Ό λ³€κ²½ν•  μ μλ‹¤.</p>
<p>MySQL μ„λ²„μ λ°”μ΄λ„λ¦¬ λ΅κ·Έ νμΌμ΄ μ•”νΈν™”λΌ μλ”μ§€ μ—¬λ¶€ ν™•μΈ λ°©λ²•</p>
<pre><code class="language-sql">mysql&gt; SHOW BINARY LOGS;</code></pre>
<hr />
<h3 id="mysqlbinlog-λ„κµ¬-ν™μ©">mysqlbinlog λ„κµ¬ ν™μ©</h3>
<p>λ°”μ΄λ„λ¦¬ λ΅κ·Έ νμΌμ΄ ν• λ² μ•”νΈν™”λλ©΄ λ°”μ΄λ„λ¦¬ λ΅κ·Έ μ•”νΈν™” ν‚¤κ°€ μ—†μΌλ©΄ λ³µνΈν™”ν•  μ μ—†λ‹¤.</p>
<p>κ·Όλ°, μ•”νΈν™” ν‚¤λ” MySQL μ„λ²„λ§ κ°–κ³  μμ–΄μ„ λ³µνΈν™”κ°€ λ¶κ°€λ¥ν•λ‹¤..</p>
<p><code>mysqlbinlog</code>λ¥Ό ν™μ©ν•΄μ„ MySQL μ„λ²„μ— μ ‘μ†ν•΄μ„ λ°”μ΄λ„λ¦¬ λ΅κ·Έλ¥Ό κ°€μ Έμ¤λ” λ°©λ²•λ°–μ— μ—†λ‹¤.</p>
<pre><code class="language-sql">linux&gt; mysqlbinlog --read-from-remote-server -uroot -p -vvv mysql-bin.000011</code></pre>
<p>mysql-bin.000011 λ΅κ·Έ νμΌμ„ κ°€μ§€κ³  μλ‹¤λ” κ°€μ •ν•μ— mysql-bin.000011 λ΅κ·Έ νμΌμ λ‚΄μ©μ„ ν™•μΈν•κ³ μ ν•λ‹¤λ©΄, μ„μ™€ κ°™μ΄ ν•λ” μλ°–μ— μ—†λ‹¤.</p>
<p>mysqlbinlog λ„κµ¬κ°€ mysql-bin.000011 νμΌμ„ μ½λ” κ²ƒμ€ μ•„λ‹κΈ° λ•λ¬Έμ— <code>--read-from</code> νλΌλ―Έν„°κ°€ ν•„μ”ν•λ‹¤.</p>